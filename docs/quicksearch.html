<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"global.html":{"id":"global.html","title":"Global","body":" Documentation Classes APIErrorAuthControllerExtendableErrorThingControllerThingServiceUserControllerUserService Global ThingSchemaUserSchema Global Members &lt;constant&gt; ThingSchema Thing Schema &lt;constant&gt; UserSchema User Schema Type Definitions Thing User × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-05T01:34:33-05:00 using the DocStrap template. "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Classes APIErrorAuthControllerExtendableErrorThingControllerThingServiceUserControllerUserService Global ThingSchemaUserSchema Classes Classes APIError AuthController ExtendableError ThingController ThingService UserController UserService × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-05T01:34:33-05:00 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Classes APIErrorAuthControllerExtendableErrorThingControllerThingServiceUserControllerUserService Global ThingSchemaUserSchema Express Rest API Server Boilerplate Overview This is a boilerplate application for building REST APIs with Express, Mongoose, permission based JWT Authentication and Mocha tests. Created with attempting to follow Node.js Best Practices as closely as possible. Features Feature Summary Authentication via JsonWebToken Supports authentication using jsonwebtoken. Code Linting JavaScript code linting is done using ESLint - a pluggable linter tool for identifying and reporting on patterns in JavaScript. Uses ESLint with eslint-config-airbnb, which tries to follow the Airbnb JavaScript style guide. Auto server restart Restart the server using nodemon in real-time anytime an edit is made, with babel compilation and eslint. Debugging via debug Instead of inserting and deleting console.log you can replace it with the debug function and just leave it there. You can then selectively debug portions of your code by setting DEBUG env variable. If DEBUG env variable is not set, nothing is displayed to the console. API parameter validation via express-validation Validate body, params, query, headers and cookies of a request (via middleware) and return a response with errors; if any of the configured validation rules fail. You won't anymore need to make your route handler dirty with such validations. Pre-commit hooks Runs lint and tests before any commit is made locally, making sure that only tested and quality code is committed Secure app via helmet Helmet helps secure Express apps by setting various HTTP headers. Uses yarn over npm Uses new released yarn package manager by facebook. You can read more about it here CORS support via cors Uses http-status to set http status code. It is recommended to use httpStatus.INTERNAL_SERVER_ERROR instead of directly using 500 when setting status code. Has .editorconfig which helps developers define and maintain consistent coding styles between different editors and IDEs. Getting Started Clone the repo: git clone https://github.com/TrevorN1126/express-mongodb-rest-api-server.git cd express-mongodb-rest-api-server Install yarn: npm install -g yarn Install dependencies: yarn Set environment (vars): cp .env.example .env Seed database with a test admin and user: (Not a best practice but these users are needed in yarn test to get the jwt) yarn seed Start server: # Start server yarn start # start server with nodemon yarn start-dev # Selectively set DEBUG env var to get logs DEBUG=express-mongodb-rest-api-server:* yarn start Refer debug to know how to selectively turn on logs. Tests: # Run tests written in ES6 yarn test # Run tests on file change yarn test:watch Lint: # Lint code with ESLint yarn lint # Run lint on any file change yarn lint:watch Deployment # compile to ES5 1. yarn build # upload dist/ to your server 2. scp -rp dist/ user@dest:/path # install production dependencies only 3. yarn --production Routes Protected Routes require a jwt header to access and the listed permission on the user Authorization: Bearer {token} Auth POST /api/auth/login - Returns token if correct username and password is provided GET /api/auth/random-number - Example route that return a random number protected route (no permission required) User GET /api/users - Get list of users protected route (admin permission required) POST /api/users - Create new user protected route (admin permission required) GET /api/users/:userId - Get user protected route (admin permission required) PUT /api/users/:userId - Update user protected route (admin permission required) DELETE /api/users/:userId - Delete user protected route (admin permission required) Thing GET /api/things - Get list of things public route (no permission required) POST /api/things - Create new thing protected route (admin or user permission required) GET /api/things/:thingId - Get thing public route (no permission required) PUT /api/things/:thingId - Update thing protected route (admin permission required) DELETE /api/things/:thingId - Delete thing protected route (admin permission required) Project Structure Layered Component based Folders under the /server directory are organized into self-contained components that don't share files with others, each constitutes very few files (e.g. models, routes, controllers, services, test, etc.) so that it's very easy to reason about it. This not only draws a clean separation of concerns but also significantly eases mocking and testing the system. *.model.js : Defines db model used by mongoose *.route.js : Uses an express.Router() to define the endpoint, register middleware and then calls the component controller *.controller.js : Sets up any req variables, then calls the services and handles the res back to the route *.service.js : Handles any business logic or db calls (ideally db abstractions should be their own layer and then called by the service layer) *.test.js : Defines all test for the Component Logging Universal logging library winston is used for logging. It has support for multiple transports. A transport is essentially a storage device for your logs. Each instance of a winston logger can have multiple transports configured at different levels. For example, one may want error logs to be stored in a persistent remote location (like a database), but all logs output to the console or a local file. We just log to the console for simplicity, you can configure more transports as per your requirement. API logging Logs detailed info about each api request to console during development. Error logging Logs stacktrace of error to console along with other details. You should ideally store all error messages persistently. Contributing For code contributions submit a pull request with unit test. License This project is licensed under the MIT License Index user/user.controller.js user.controller.js Controller for the user component Index user/user.service.js user.service.js Service for the user component × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-05T01:34:33-05:00 using the DocStrap template. "},"APIError.html":{"id":"APIError.html","title":"Class: APIError","body":" Documentation Classes APIErrorAuthControllerExtendableErrorThingControllerThingServiceUserControllerUserService Global ThingSchemaUserSchema Class: APIError APIError Class representing an API error. new APIError(message, status, isPublic) Creates an API error. Parameters: Name Type Default Description message string Error message. status number HTTP status code of error. isPublic boolean false Whether the message should be visible to user or not. Extends ExtendableError × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-05T01:34:33-05:00 using the DocStrap template. "},"AuthController.html":{"id":"AuthController.html","title":"Class: AuthController","body":" Documentation Classes APIErrorAuthControllerExtendableErrorThingControllerThingServiceUserControllerUserService Global ThingSchemaUserSchema Class: AuthController AuthController UserController Class. new AuthController() Methods getRandomNumber(req, res) This is a protected route. Will return random number only if jwt token is provided in header. Parameters: Name Type Description req res Returns: Type * login(req, res, next) Returns jwt token if username is stored in the databse and the password matches Parameters: Name Type Description req res next Returns: Type * × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-05T01:34:33-05:00 using the DocStrap template. "},"ExtendableError.html":{"id":"ExtendableError.html","title":"Class: ExtendableError","body":" Documentation Classes APIErrorAuthControllerExtendableErrorThingControllerThingServiceUserControllerUserService Global ThingSchemaUserSchema Class: ExtendableError ExtendableError new ExtendableError() Extends Error × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-05T01:34:33-05:00 using the DocStrap template. "},"ThingController.html":{"id":"ThingController.html","title":"Class: ThingController","body":" Documentation Classes APIErrorAuthControllerExtendableErrorThingControllerThingServiceUserControllerUserService Global ThingSchemaUserSchema Class: ThingController ThingController ThingController Class. new ThingController() Methods &lt;async&gt; create() Create new thing Properties: Name Type Description req.body.name string The name of a thing. req.body.description string The description of a thing. Returns: Type Thing &lt;async&gt; get() Get an existing thing Properties: Name Type Description req.params.thingId string The _id of thing. Returns: Type Thing &lt;async&gt; list() Get thing list. Returns: Type Array.&lt;Thing&gt; &lt;async&gt; remove() Delete thing. Returns: Type Thing &lt;async&gt; update() Update existing thing Properties: Name Type Description req.params.thingId string The _id of thing. req.body object Object containing new values for the thing. Returns: Type Thing × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-05T01:34:33-05:00 using the DocStrap template. "},"ThingService.html":{"id":"ThingService.html","title":"Class: ThingService","body":" Documentation Classes APIErrorAuthControllerExtendableErrorThingControllerThingServiceUserControllerUserService Global ThingSchemaUserSchema Class: ThingService ThingService Creates a new ThingService. new ThingService() × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-05T01:34:33-05:00 using the DocStrap template. "},"UserController.html":{"id":"UserController.html","title":"Class: UserController","body":" Documentation Classes APIErrorAuthControllerExtendableErrorThingControllerThingServiceUserControllerUserService Global ThingSchemaUserSchema Class: UserController UserController UserController Class. new UserController() Methods &lt;async&gt; create() Create new user Properties: Name Type Description req.body.username string The username of user. req.body.password string The password of user. req.body.permissions Array.&lt;string&gt; Array of strings for the permissions Returns: Type User &lt;async&gt; get() Get an existing user Properties: Name Type Description req.params.userId string The _id of user. Returns: Type User &lt;async&gt; list() Get user list. Properties: Name Type Description req.query.skip number Number of users to be skipped. req.query.limit number Limit number of users to be returned. Returns: Type Array.&lt;User&gt; &lt;async&gt; remove() Delete user. Properties: Name Type Description req.params.userId string The _id of user. Returns: Type User &lt;async&gt; update() Update existing user Properties: Name Type Description req.params.userId string The _id of user. req.body object Object containing new values for the user. Returns: Type User × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-05T01:34:33-05:00 using the DocStrap template. "},"UserService.html":{"id":"UserService.html","title":"Class: UserService","body":" Documentation Classes APIErrorAuthControllerExtendableErrorThingControllerThingServiceUserControllerUserService Global ThingSchemaUserSchema Class: UserService UserService Creates a new UserService. new UserService() Methods &lt;async&gt; Create() Create a new user Returns: user Type object &lt;async&gt; GetUser() Get a user Returns: user Type object &lt;async&gt; List() Get a list of all users Returns: user - An array of users Type Array.&lt;object&gt; &lt;async&gt; Update() Update a user Returns: user Type object × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-05T01:34:33-05:00 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
